version: "3.0"

# Test workflow to demonstrate job names and dependencies
jobs:
  setup-data:
    command: "bash"
    args: [ "-c", "echo 'Setting up data...' && sleep 2 && echo 'Data setup complete'" ]
    environment:
      TASK: "setup"
    resources:
      max_memory: 64

  process-data:
    command: "bash"
    args: [ "-c", "echo 'Processing data from setup...' && sleep 3 && echo 'Processing complete'" ]
    environment:
      TASK: "process"
    requires:
      - setup-data: "COMPLETED"
    resources:
      max_memory: 64

  validate-results:
    command: "bash"
    args: [ "-c", "echo 'Validating processed results...' && sleep 1 && echo 'Validation successful'" ]
    environment:
      TASK: "validate"
    requires:
      - process-data: "COMPLETED"
    resources:
      max_memory: 64

  generate-report:
    command: "bash"
    args: [ "-c", "echo 'Generating final report...' && sleep 2 && echo 'Report generated successfully'" ]
    environment:
      TASK: "report"
    secret_environment:
      REPORT_KEY: "secret-report-token-123"
    requires:
      - validate-results: "COMPLETED"
    resources:
      max_memory: 64